services:
 redis:
  image: redis:7.4
  restart: unless-stopped
  ports:
   - "127.0.0.1:6379:6379"
  command: redis-server /usr/local/etc/redis/redis.conf
  volumes:
   - ./configs/redis.conf:/usr/local/etc/redis/redis.conf
  ulimits:
   nproc: 65535
   nofile:
    soft: 65535
    hard: 65535
  deploy:
   resources:
    limits:
     cpus: "4"
     memory: 25G
    reservations:
     cpus: "2"
     memory: 4G
  networks:
   - default

 nirn:
  image: ghcr.io/germanoeich/nirn-proxy:v1.3.3
  restart: unless-stopped
  environment:
   REQUEST_TIMEOUT: 15000
  ports:
   - "127.0.0.1:8080:8080"
  networks:
   - default

networks:
 default:
  driver: bridge
